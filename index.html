<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç£é»‘ç†Šå‡ºæ²’åœ°åœ– (å³æ™‚æ›´æ–°)</title>
    
    <!-- å¼•å…¥ Leaflet åœ°åœ–å¥—ä»¶çš„ CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 100vh; width: 100%; } /* åœ°åœ–ä½”æ»¿å…¨è¢å¹• */
        
        /* è³‡è¨Šæ¡†æ¨£å¼ */
        .info-box {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            font-family: sans-serif;
        }
    </style>
</head>
<body>

    <!-- é¡¯ç¤ºæœ€å¾Œæ›´æ–°æ™‚é–“çš„å°æ¡†æ¡† -->
    <div class="info-box">
        <h3>ğŸ» é»‘ç†Šåœ°åœ–</h3>
        <p>è³‡æ–™ä¾†æºï¼šè‡ªå‹•çˆ¬èŸ²</p>
        <p id="status">è¼‰å…¥ä¸­...</p>
    </div>

    <!-- åœ°åœ–å®¹å™¨ -->
    <div id="map"></div>

    <!-- å¼•å…¥ Leaflet åœ°åœ–å¥—ä»¶çš„ JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // 1. åˆå§‹åŒ–åœ°åœ–ï¼Œä¸­å¿ƒé»è¨­åœ¨å°ç£ï¼Œç¸®æ”¾å±¤ç´š 8
        const map = L.map('map').setView([23.6978, 120.9605], 8);

        // 2. åŠ å…¥ OpenStreetMap åœ–è³‡
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // 3. é€™æ˜¯æœ€é—œéµçš„ä¸€æ­¥ï¼šå»æŠ“å– data/bears.json æª”æ¡ˆ
        // æ³¨æ„ï¼šé€™è£¡çš„è·¯å¾‘å¿…é ˆå°æ‡‰åˆ°ä½ çˆ¬èŸ²å­˜æª”çš„è·¯å¾‘
        fetch('./data/bears.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error("æ‰¾ä¸åˆ°è³‡æ–™æª” (å¯èƒ½æ˜¯çˆ¬èŸ²é‚„æ²’è·‘å®Œ)");
                }
                return response.json();
            })
            .then(data => {
                // æ›´æ–°ç‹€æ…‹æ–‡å­—
                document.getElementById('status').innerText = `ç›®å‰å…±æœ‰ ${data.length} ç­†ç´€éŒ„`;

                // 4. è·‘è¿´åœˆï¼ŒæŠŠæ¯ä¸€éš»ç†Šç•«åœ¨åœ°åœ–ä¸Š
                data.forEach(bear => {
                    // æª¢æŸ¥æ˜¯å¦æœ‰ç¶“ç·¯åº¦è³‡æ–™
                    if (bear.geo && bear.geo.lat && bear.geo.long) {
                        
                        // å»ºç«‹æ¨™è¨˜ (Marker)
                        const marker = L.marker([bear.geo.lat, bear.geo.long]).addTo(map);
                        
                        // æº–å‚™å½ˆå‡ºè¦–çª—çš„å…§å®¹ (Popup)
                        const popupContent = `
                            <b>åœ°é»ï¼š</b> ${bear.location}<br>
                            <b>æ™‚é–“ï¼š</b> ${bear.time}<br>
                            <br>
                            <img src="${bear.image}" style="width:100%; max-width:200px; border-radius:5px;">
                        `;

                        marker.bindPopup(popupContent);
                    }
                });
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('status').innerText = "è®€å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Console";
            });
    </script>
</body>
</html>
